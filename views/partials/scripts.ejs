<!-- <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script> -->
<!-- <script src='https://code.jquery.com/jquery-3.3.1.min.js'></script> -->

<script>   

    var ws = new WebSocket('ws://www.seismicportal.eu/standing_order/websocket')

    ws.onopen = () => {
        // websocket connection opened
        console.log('websocket opened on browser')


    }

    ws.onmessage = (message) => {
        // message from server
        console.log(message.data)
    }

    ws.onclose = (event) => {
        // websocket connection closes for unknown reason thus open a connection again
        console.log("websocket closed")
        console.log(event);
        ws = new WebSocket('ws://www.seismicportal.eu/standing_order/websocket')
    }


    // when browser is closed or navigates away close the webbsocket
    // $(window).on("beforeunload", function() {
    window.onbeforeunload = function(event) {
        console.log("browser going away");

        // disable ws.onclose() function
        ws.onclose = function() {};
        ws.close();
    };

    // keep websocket connection open by sending a message to the server every 5 minutes
    setTimeout(function() {
        ws.send("ping")
        console.log("websocket server pinged");
    }, 15000);


</script>  