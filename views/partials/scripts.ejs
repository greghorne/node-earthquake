<script>   

    var ws = new WebSocket('ws://www.seismicportal.eu/standing_order/websocket')

    ws.onopen = () => {
        console.log("websocket opened");
    }

    ws.onmessage = (message) => {
        console.log("data received");
        console.log(message.data);
    }

    ws.onclose = (event) => {
        console.log("websocket closed");
        console.log(event);
    }


    // when browser is closed or navigates away close the webbsocket
    window.onbeforeunload = (event) => {
        console.log("browser going away (close or redirect)");
        // ws.onclose = function() {};
        ws.close();
    };

    var counter = 1;

    // keep websocket connection open by sending a message to the server every 5 minutes
    window.setInterval = (function() {
        ws.send("ping");
        console.log("ping...", counter);
        counter++;
    }, 300000);


</script>  